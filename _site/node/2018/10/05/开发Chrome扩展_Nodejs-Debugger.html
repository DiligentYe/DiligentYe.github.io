<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>开发Chrome扩展——Nodejs Debugger | Test</title>
<meta name="generator" content="Jekyll v3.8.4" />
<meta property="og:title" content="开发Chrome扩展——Nodejs Debugger" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Good Good Study, Day Day Up!" />
<meta property="og:description" content="Good Good Study, Day Day Up!" />
<link rel="canonical" href="http://localhost:4000/node/2018/10/05/%E5%BC%80%E5%8F%91Chrome%E6%89%A9%E5%B1%95_Nodejs-Debugger.html" />
<meta property="og:url" content="http://localhost:4000/node/2018/10/05/%E5%BC%80%E5%8F%91Chrome%E6%89%A9%E5%B1%95_Nodejs-Debugger.html" />
<meta property="og:site_name" content="Test" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-10-05T20:20:29+08:00" />
<script type="application/ld+json">
{"url":"http://localhost:4000/node/2018/10/05/%E5%BC%80%E5%8F%91Chrome%E6%89%A9%E5%B1%95_Nodejs-Debugger.html","headline":"开发Chrome扩展——Nodejs Debugger","dateModified":"2018-10-05T20:20:29+08:00","datePublished":"2018-10-05T20:20:29+08:00","description":"Good Good Study, Day Day Up!","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/node/2018/10/05/%E5%BC%80%E5%8F%91Chrome%E6%89%A9%E5%B1%95_Nodejs-Debugger.html"},"@type":"BlogPosting","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Test" /><link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Test</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <!-- <div class="trigger"><a class="page-link" href="/about/">About</a></div> -->
        <div class="trigger"><ul class="social-media-list"><li><a href="https://github.com/DiligentYe"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">开发Chrome扩展——Nodejs Debugger</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-10-05T20:20:29+08:00" itemprop="datePublished">Oct 5, 2018
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><img src="http://upload-images.jianshu.io/upload_images/5796375-be1c852b0ca34f7a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Node.js Debugger" /></p>

<h3 id="目录">目录</h3>
<ol>
  <li>Node.js Debugger扩展展示及下载地址</li>
  <li>Node.js Debugger使用介绍</li>
  <li>Node.js Debugger开发思想</li>
  <li>待改进</li>
  <li>相关资料</li>
</ol>

<h3 id="1-nodejs-debugger扩展展示及下载地址">1. Node.js Debugger扩展展示及下载地址</h3>
<h4 id="nodejs-debugger扩展展示">Node.js Debugger扩展展示</h4>
<ol>
  <li>
    <p>初始页面
<img src="http://upload-images.jianshu.io/upload_images/5796375-6a69581ae22d879d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="初始展示页面" /></p>
  </li>
  <li>
    <p>操作失败页面
<img src="http://upload-images.jianshu.io/upload_images/5796375-d4b5f305466e8e31.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="操作失败页面" /></p>
  </li>
</ol>

<h4 id="nodejs-debugger扩展下载地址">Node.js Debugger扩展下载地址</h4>

<p><strong>百度网盘地址：</strong><a href="https://pan.baidu.com/s/1c1KLk5a">https://pan.baidu.com/s/1c1KLk5a</a></p>

<h3 id="2-nodejs-debugger使用介绍">2. Node.js Debugger使用介绍</h3>
<h4 id="安装chrome扩展">安装Chrome扩展</h4>
<ol>
  <li>打开Chrome扩展程序面板。<img src="http://upload-images.jianshu.io/upload_images/5796375-508c712155506f9e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="扩展工具程序面板入口" /></li>
</ol>

<p>2.直接将的.crx文件拖拽到扩展程序面板中，添加扩展程序。<img src="http://upload-images.jianshu.io/upload_images/5796375-caee8bf6ad115fd5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="屏幕快照 2017-11-30 13.23.31.png" /></p>

<ol>
  <li>添加扩展程序成功，可以在工具栏看到我们扩展程序的图标（绿色小图标）。<img src="http://upload-images.jianshu.io/upload_images/5796375-b7228f890c2f0283.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加成功提示" /></li>
</ol>

<h4 id="nodejs-debugger扩展程序使用介绍">Node.js Debugger扩展程序使用介绍</h4>
<ol>
  <li>输入主机名和端口号，默认情况下主机名为localhost，端口号为9229，如果在启动node inspector时，你使用的不是–inspect，而是–inspect=127.0.0.1:8000，此时Chrome与node inspector的通信端口为8000，因此，你需要重新设置端口。
<strong>情况一：</strong>
<img src="http://upload-images.jianshu.io/upload_images/5796375-fe7160ba73ad2033.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="使用--inspect参数" />此时，打开Chrome，点击扩展程序，直接点击调试即可。</li>
</ol>

<p><strong>情况二：</strong>
<img src="http://upload-images.jianshu.io/upload_images/5796375-398cd9ec38464978.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="使用--inspect=ip:port参数" /></p>

<p><img src="http://upload-images.jianshu.io/upload_images/5796375-d3b636b04125b15c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="设置端口号9000" /></p>

<p>此时，就必须设置端口号，如果不设置点击调试的话，就会弹出弹出层，而不能正确访问调试页面。</p>

<h4 id="使用过程中注意事项">使用过程中注意事项</h4>
<ol>
  <li>
    <p>确保node版本是7.x.x以上
node inspector功能是在7.x.x版本以上才能使用。因此，如果当你点击调试按钮，弹出先标签页，但是页面一直在转圈，此时，你就要查看一下，是否是你的node版本太低了。</p>
  </li>
  <li>
    <p>确保启动了node inspector，并且<strong>建议使用–inspect-brk来启动</strong>
如果你使用–inspect启动node inspector，并且你调试的只是一个过程式的js，此时你的代码在调试之前就已经执行完，无法再进行调试，而是用–inspect-brk来启动，将在所有程序的开头开始调试，此时，你便可以在调试面板上添加断点进行调试。</p>
  </li>
  <li>
    <p>端口号设置问题
确定输入框中设置的端口号是否正确，并且端口号是否已经被占用。如果你设置的端口号已经已经被使用了，此时插件内部可能报错，但是并不会直接显示到插件展示页面上，因此，如果发现点击调试按钮不弹出弹出层，也不弹出新的标签页，请检查你的端口号是否被占用了。</p>
  </li>
  <li>
    <p>一次调试完成后，不能直接刷新页面，开始下一轮调试
此时需要重新启动新的node inspector，在按照上面的步骤打开页面，否则可能会出现，无法进行调试，或者无法打开调试页面的情况。</p>
  </li>
</ol>

<h3 id="3-nodejs-debugger开发思想">3. Node.js Debugger开发思想</h3>
<p>Inspector clients must know and specify host address, port, and UUID to connect to the WebSocket interface. The full URL is ws://127.0.0.1:9229/0f2c936f-b1cd-4ac9-aab3-f63b0f33d55e, of course dependent on actual host and port and with the correct UUID for the instance.
Node.js v7+版本提供了一个inspector的功能，在使用node运行js程序时，可以添加–inspector打开这个功能。
<strong>该功能为Chrome DevTools提供了一个通信接口，这是的Node进程可以和Chrome DevTools使用websocket直接进行通信</strong>。
同时，也提供了用户接口，用户可以通过访问
<strong>http://IP:port/json/list</strong>访问到这个接口的相关信息，其中webSocketDebuggerUrl就是Chrome DevTools和Node进程的websocket通信地址，而<strong>devtoolsFrontendUrl，就是我们可以访问的调试面板地址</strong>。</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ {
  "description": "node.js instance",
  "devtoolsFrontendUrl": "chrome-devtools://devtools/bundled/inspector.html?experiments=true&amp;v8only=true&amp;ws=127.0.0.1:9000/ce3d915c-367e-4751-980c-a50cede6379d",
  "faviconUrl": "https://nodejs.org/static/favicon.ico",
  "id": "ce3d915c-367e-4751-980c-a50cede6379d",
  "title": "test.js",
  "type": "node",
  "url": "file:///Users/yyp/Desktop/test.js",
  "webSocketDebuggerUrl": "ws://127.0.0.1:9000/ce3d915c-367e-4751-980c-a50cede6379d"
} ]
</code></pre></div></div>
<p>因此我们<strong>通过http://IP:port/json/list返回数据中的devtoolsFrontendUrl字段，获取调试页面地址，然后在chrome插件中创建一个新的标签页，并且将该字段作为新标签页的url即可</strong>。</p>

<h3 id="4-待改进">4. 待改进</h3>
<ol>
  <li>启动扩展程序时，第一个输入框被选中，出现蓝色背景。</li>
  <li>未提供用户设置选项。</li>
</ol>

<h3 id="5-相关资料">5. 相关资料</h3>
<ol>
  <li>
    <p>node inspector 相关
<a href="https://nodejs.org/en/docs/guides/debugging-getting-started/#debugging-guide"><strong>Debugging Guide</strong>: https://nodejs.org/en/docs/guides/debugging-getting-started/#debugging-guide</a>
<a href="https://nodejs.org/en/docs/inspector/"><strong>Debugging Node.js Apps</strong>: https://nodejs.org/en/docs/inspector/</a>
<a href="http://www.jianshu.com/p/3ed910d3866c"><strong>如何在Chrome DevTools 中对Node程序进行调试</strong>: http://www.jianshu.com/p/3ed910d3866c</a></p>
  </li>
  <li>
    <p>Chrome 插件开发相关
<a href="http://www.ituring.com.cn/book/1421"><strong>Chrome扩展及应用开发（首发版）</strong>:http://www.ituring.com.cn/book/1421</a>
<a href="https://chajian.baidu.com/developer/extensions/getstarted.html"><strong>百度浏览器开发文档</strong>：https://chajian.baidu.com/developer/extensions/getstarted.html</a></p>
  </li>
  <li>
    <p>源码
<a href="https://github.com/DiligentYe/todo-list-chrome-extension/tree/nodejs-debugger"><strong>github地址</strong>：https://github.com/DiligentYe/todo-list-chrome-extension/tree/nodejs-debugger</a></p>
  </li>
</ol>


  </div><a class="u-url" href="/node/2018/10/05/%E5%BC%80%E5%8F%91Chrome%E6%89%A9%E5%B1%95_Nodejs-Debugger.html" hidden></a>
</article>

        <div id="gitalk-container"></div>
      </div>
    </main>

    <!--<footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Test</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Test</li><li><a class="u-email" href="mailto:yeyingping26@gmail.com">yeyingping26@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/DiligentYe"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Good Good Study, Day Day Up!</p>
      </div>
    </div>

  </div>

</footer>
-->
    <script>
    const gitalk = new Gitalk({
      clientID: '4567a3c4249760e03c45',
      clientSecret: 'ac62226f3a5245f0edb4e548af2f970490679e53', 
      id: window.location.pathname, 
      repo: 'DiligentYe.github.io', 
      owner: 'DiligentYe', 
      admin: 'DiligentYe', 
      distractionFreeMode: true,
    })

    gitalk.render('gitalk-container')
    </script>
  </body>

</html>
